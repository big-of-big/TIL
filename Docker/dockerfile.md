## Dockerfileからイメージをビルドする
```
docker build -t <name>:<tag> .
```
`-t`で名前をつける。名前がないイメージはダングリングイメージと言う。

## レイヤーについて
- Docker imageのレイヤー数は最小限にする
- レイヤーを作るのはRUN, COPY, ADD
- コマンドは&&でつなぐ
- \で改行する

## パッケージのインストール
新しいパッケージリストを取得してから
```
apt-get update
```
これを実行`apt-get install <package>`

## キャッシュについて
キャッシュはRUNごと、つまりレイヤーごとにおこる。
開発途中はRUNを細かく分けて、キャッシュを利用することで高速化する。
最後に短くまとめる。

## CMDについて
CMDでコンテナのデフォルトのコマンドを指定する。
原則Dockerfileの最後に記述する。
1つのDockerfileにCMDは1つだけ。
RUNはレイヤーを作るがCMDは作らない。

## ビルドゴンテキストについて
- ビルドに使わないファイルはビルドコンテキストに入れない
- ADDやCOPYでビルドコンテキストにあるファイルをimageに持っていける

## COPY
COPYインストラクションはホスト（自分のMac）上のファイルやディレクトリをコンテナの中に持っていくために使う。

## COPYとADDの違い
基本COPYを使う。ADDはtarの圧縮ファイルをコピーして解凍したい時に使う。

## ENV:環境変数を設定する
コンテナの中で使う環境変数は以下のように設定できる
```
FROM ubuntu:latest
ENV name lamp
ENV age=25
````

## WORKDIR:実行ディレクトリを変更する
Dockerはたとえcdコマンドを使ったとしても、ルートディレクトリにいる想定でコマンドを実行してしまう。
しかし&&で繋げるとcdを行ったディレクトリで任意のコマンドを実行できる。(RUNを複数書くとうまくいかない。)
このコマンドは指定したディレクトリがない場合作成までやってくれる。
